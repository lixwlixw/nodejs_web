<!DOCTYPE html>
<html>
<head lang="en">
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/command.css">
    <link rel="stylesheet" href="./css/clientDownload.css">
    <script language="JavaScript" src="./js/jquery.min.js"></script>
    <script language="JavaScript" src="./js/ngUrl.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/ngUrl.js"></script>
    <script src="js/login.js"></script>
    <script src="js/base64.js"></script>
    <script src="js/md5.js"></script>
    <script src="js/jquery.cookie.js"></script>
</head>
<body>
<!-- 头部导航 -->
<header></header>
<div class="clientTop">
    Client端工具下载
</div>
<div class="container">
        <div class="clientTitle">
            <div class="titleImg title1"></div><strong>安装client端工具</strong>
        </div>
        <div class="boxworp">
            <!--<p class="nobg_p">-->
                <!--在安装GO(需要GO1.4以上版本)语言和设置了GOPATH环境变量之后，安装datahub-client:-->
            <!--</p>-->
            <p class="bg_p">
                curl http://hub.dataos.io/install.sh | sh -s xxxxxxxxxxxxxxxx
            </p>
            <p class="nobg_p">
                使用源码安装：
            </p>
            <p class="bg_p">
                go get github.com/asiainfoLDP/datahub
            </p>
            <p class="nobg_p">
                启动datahub服务：
            </p>
            <p class="bg_p">
                sudo $GOPATH/bin/datahub --daemon --token <span class="havetoken">xxxxxxxxxxx</span>
            </p>
            <p class="nobg_p">
                使用docker镜像：
            </p>
            <p class="bg_p">
                git clone https://github.com/asiainfoLDP/datahub  && cd datahub<br/>
                docker build -t datahub .
            </p>
            <p class="nobg_p">
                启动docker镜像：
            </p>
            <p class="bg_p">
                docker run -d -e "DAEMON_TOKEN=<span class="havetoken"></span>" -e "DAEMON_ENTRYPOINT=http://XXXXXXXXXX:YYYY" -p xxxx:35800 datahub
            </p>
            <p>
                需要修改防火墙，使得docker镜像的35800映射到的主机端口可以被外部访问。
            </p>
        </div>
        <div class="clientTitle">
            <div class="titleImg title2"></div><strong>运行client端命令行</strong>
        </div>
        <div class="boxworp">
            <p class="nobg_p">
               datahub CLI是datahub-client的命令行客户端，用来执行datahub相关命令。
            </p>
            <p class="bmargin fcolor0">
                db
            </p>
            <p class="smargin fcolor6">
                管理datapool
            </p>
            <p class="smargin fcolor0">
                repo
            </p>
            <p class="smargin fcolor6">
                Repository管理
            </p>
            <p class="smargin fcolor0">
               subs
            </p>
            <p class="smargin fcolor6">
                Subscrption管理
            </p>
            <p class="smargin fcolor0">
                login
            </p>
            <p class="smargin fcolor6">
                登录到dataos.io
            </p>
            <p class="smargin fcolor0">
                pull
            </p>
            <p class="smargin fcolor6">
               下载数据
            </p>
        </div>
        <div class="clientTitle">
            <div class="titleImg title3"></div><strong>运行client端命令行</strong>
        </div>
        <div class="boxworp">
            <div class="notebox bddashed">
                <p>NOTE:</p>
                <ul>
                    <li>如果没有额外说明，所有的命令在没有错误发生时，不在终端输出任何信息，只记录到日志中。错误信息会打印到终端。</li>
                    <li>所有的命令执行都会记录到日志中，日志级别分[TRACE] [INFO] [WARNNING] [ERROR] [FATAL]。</li>
                    <li>参数支持全名和简称两种形式，例如--type等同于-t。详情见命令帮助。</li>
                    <li>参数赋值支持空格和等号两种形式，例如--type=file等同于--type file。</li>
                </ul>
            </div>
            <div class="smalltitle fcolor0">
                 <span class="smallbg"></span><span>Datapool相关命令</span>
            </div>
            <div style="padding-left:18px;">
                <p class="nobg_p fcolor0">
                    1.列出所有命令池
                </p>
                <div style="padding-left:10px;">
                         <p class="bg_p">
                             datahub&nbsp;&nbsp;dp
                         </p>
                         <p class="smargin fcolor0">
                             输出
                         </p>
                         <p class="bg_p">
                             {%DPNAME&nbsp;&nbsp;&nbsp;&nbsp;%DPTYPE}
                         </p>
                         <p class="smargin fcolor0">
                             例子
                         </p>
                         <div class="bg_p">
                             <p>$ datahub dp</p>
                             <p>dp1     regular file </p>
                             <p>dp2     db2</p>
                             <p>dphere  hdfs</p>
                             <p>dpthere api</p>
                             <p>$</p>
                         </div>
                </div>

                <p class="nobg_p fcolor0">
                    2.列出datapool详情
                </p>
                <div style="padding-left: 10px;">
                        <div class="bg_p">datahub dp $DPNAME</div>
                        <p class="smargin fcolor0">
                            输出
                        </p>
                        <div class="bg_p">
                            <p>%DPNAME %DPTYPE %DPCONN</p>
                            <p>{%REPO/%ITEM:%TAG       %LOCAL_TIME     %T}</p>
                        </div>
                        <p class="smargin fcolor0">
                            例子
                        </p>
                        <div class="bg_p">
                            <p>$ datahub dp dp1</p>
                            <p>dp1 regular file    /var/lib/datahub/dp1</p>
                            <p>repo1/item1:tag1        12:34 Oct 11 2015       pub</p>
                            <p>repo1/item1:tag2        15:00 Nov 2  2015       pub</p>
                            <p>repo1/item2:latest  10:00 Nov 1  2015       pull</p>
                            <p>cmcc/beijing:latest 10:00 Nov 1  2015       pull</p>
                            <p>$</p>
                        </div>
                </div>
                <p class="nobg_p fcolor0">
                    3.创建数据池
                </p>
                <div style="padding-left:10px;">
                        <div class="notebox bddashed">
                            目前只支持本地目录的数据池创建。daemon会有自己的可配置目录(默认/var/lib/datahub),使用参数dpconn指定据对路径，当没有设置dpconn选项时，会默认创建到daemon的工作目录。
                        </div>
                        <div class="bg_p">
                            <p>datahub dp create $DPNAME [--type=$dptype]</p>
                            <p>[--conn=$dpconn]</p>
                        </div>
                        <p class="smargin fcolor0">
                            输出
                        </p>
                        <div class="bg_p">
                            <p>%msg</p>
                        </div>
                        <p class="smargin fcolor0">
                            例子
                        </p>
                        <div class="bg_p">
                            <p>$ datahub dp create dp1 --type=file</p>
                            <p>--conn=/home/daemon/dp1</p>
                            <p>dp1 created as /home/daemon/dp1</p>
                            <p>$</p>
                        </div>
                </div>
                <p class="nobg_p fcolor0">
                    4.删除数据池
                </p>
                <div style="padding-left: 10px;">
                        <div class="notebox bddashed">
                            删除数据池不会删除目标数据池已保存的数据，该dp有发布的数据项时，不能被删除。删除是在sqlit中标记状态，不真实删除。
                        </div>
                        <div class="bg_p">
                            <p>datahub dp rm $DPNAME [-f]</p>
                        </div>
                        <p class="smargin fcolor0">
                            输出
                        </p>
                        <div class="bg_p">
                            <p></p>
                        </div>
                        <p class="smargin fcolor0">
                            例子
                        </p>
                        <div class="bg_p">
                            <p>$ datahub dp rm dp1</p>
                            <p>ok</p>
                            <p>$</p>
                        </div>
                </div>
            </div>
            <div class="smalltitle fcolor0">
                    <span class="smallbg"></span><span>subs相关命令</span>
            </div>
            <div style="padding-left:18px;">
                    <p class="nobg_p fcolor0">
                        1.列出所有已订阅项
                    </p>
                    <div style="padding-left: 10px">
                            <div class="bg_p">
                                <p>datahub subs </p>
                            </div>
                            <p class="smargin fcolor0">
                                输出
                            </p>
                            <div class="bg_p">
                                <p>{%REPO/%ITEM    %TYPE}</p>
                            </div>
                            <p class="smargin fcolor0">
                                例子
                            </p>
                            <div class="bg_p">
                                <p>$ datahub subs</p>
                                <p>cmcc/beijing        regular file</p>
                                <p>repo1/testing       api</p>
                                <p>$</p>
                            </div>
                    </div>
                    <p class="nobg_p fcolor0">
                        2.列出已订阅Item详情
                    </p>
                    <div style="padding-left: 10px">
                            <div class="bg_p">
                                <p>ddatahub subs $REPO/$ITEM</p>
                            </div>
                            <p class="smargin fcolor0">
                                输出
                            </p>
                            <div class="bg_p">
                                <p>%REPO/%ITEM     %TYPE</p>
                                <p>DESCRIPTION:</p>
                                <p>%DESCRIPTION</p>
                                <p>METADATA:</p>
                                <p>%METADATA</p>
                                <p>{%ITEM:%TAGNAME %UPDATE_TIME    %INFO}</p>
                            </div>
                            <p class="smargin fcolor0">
                                例子
                            </p>
                            <div class="bg_p">
                                <p>$ datahub subs cmcc/beijing</p>
                                <p>cmcc/beijing    regular file</p>
                                <p>DESCRIPTION:</p>
                                <p>移动数据北京地区</p>
                                <p>METADATA:</p>
                                <p>BLABLABLA</p>
                                <p>beijing:chaoyang    15:34 Oct 12 2015       600M</p>
                                <p>beijing:daxing  16:40 Oct 13 2015       435M</p>
                                <p>beijing:shunyi  16:40 Oct 14 2015       324M</p>
                                <p>beijing:haidian 16:40 Oct 15 2015       988M</p>
                                <p>$</p>
                            </div>
                    </div>
            </div>
            <div class="smalltitle fcolor0">
                    <span class="smallbg"></span><span>pull命令</span>
            </div>
            <div style="padding-left:18px;">
                     <p class="nobg_p fcolor0">
                         1.拉取某个item的tag
                     </p>
                     <div style="padding-left: 10px">
                            <div class="bg_p">
                                <p>datahub pull $REPO/$ITEM[:$TAG] $DATAPOOL</p>
                            </div>
                            <p class="smargin fcolor0">
                                输出
                            </p>
                            <div class="bg_p">
                                <p>%msg</p>
                            </div>
                            <p class="smargin fcolor0">
                                例子
                            </p>
                            <div class="bg_p">
                                <p>$ datahub pull cmcc/beijing:chaoyang dp1</p>
                                <p>OK.</p>
                                <p>$</p>
                            </div>
                     </div>
            </div>
            <div class="smalltitle fcolor0">
                 <span class="smallbg"></span><span>login命令</span>
            </div>
            <div style="padding-left:18px;">
                    <p class="nobg_p fcolor0">
                        1.登录到dataos.io
                    </p>
                    <div style="padding-left: 10px">
                            <div class="bg_p">
                                <p>datahub login [--user=user]</p>
                            </div>
                            <p class="smargin fcolor0">
                                输出
                            </p>
                            <div class="bg_p">
                                <p>%msg</p>
                            </div>
                            <p class="smargin fcolor0">
                                例子
                            </p>
                            <div class="bg_p">
                                <p>%msg</p>
                                <p>$ datahub login</p>
                                <p>login: datahub</p>
                                <p>password: *******</p>
                                <p>[INFO]Authorization failed.</p>
                                <p>$</p>
                            </div>
                    </div>
            </div>
        </div>
</div>
<!-- 尾部 -->
<footer></footer>
<div id="loginTem"></div>
</body>
</html>
<script>
    $("a").focus(function(){this.blur()});
    $("header").load("common/header.html");
    $("footer").load("common/footer.html");
    $("#loginTem").load("common/login.html");
    var account= $.cookie('token');

    if(account != 'null'){
        $.ajax({
            type: "get",
            url:ngUrl+"/daemon/id",
            cache:false,
            async:false,
            headers:{Authorization:"Token "+account},
            success: function(msg){
                $('.havetoken').html(msg.data.daemonid);
            }
        });
            }
    else{
        $('.havetoken').html('xxxxxxxxxx');
    }
</script>